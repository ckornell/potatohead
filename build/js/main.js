function randomCacheBuster(e,t){return Math.ceil(Math.random()*t*e)}$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},function(){function e(e){var a=$("#preview_iframe"),o=$(e),i=o.text().trim().replace(".html",""),n=t(o.data("section"),i);r.show(),a.attr("src",n)}function t(e,t){var r=o+"?layout=default";switch(e){case"header":r+="&views:header=header/";break;case"footer":r+="&views:footer=footer/";break;case"layouts":r=o+"?layout=";break;case"categories":r+="&views:categories=categories/";break;case"home":r+="&views:home=home/"}"slide_menu"===t&&(r=o+"?layout=slide_menu&views:header=header/");var i=r+t+"&refresh="+randomCacheBuster(100,300);return a.clear(),a.makeCode(i),i}var a,r=$("#loader"),o=r.data("host");$(".submenu > li a").on("click",function(){var t=$(this);e(t)}),a=new QRCode("qrcode",{text:o+"?layout=default",width:128,height:128,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H}),document.getElementById("preview_iframe").onload=function(){r.hide()}}(),function(){$(".menu > li a").on("click",function(){var e=$(this);e.parent().find("> .submenu").toggle(),e.toggleClass("open")}),$(".minicolors").minicolors({control:"wheel",theme:"default",defaultValue:"#fff"}),$(".section-btn-header").on("click",function(e){e.preventDefault();var t=$(this);t.next(".variables").toggle(),t.toggleClass("open")})}(),function(){var e=window.location.href,t=io.connect(e);$(".submit-change").on("click",function(e){e.preventDefault(),e.stopPropagation();var a=$(this).data("section"),r=$(this).parents("form").serializeObject();t.emit("stylus rewrite",{directive:a,form:r})}),t.on("refreshFrame",function(){$("#loader").show();var e=$("#preview_iframe"),t=e.attr("src"),a=randomCacheBuster(2e3,1e3);/\?layout/g.test(t)?e.attr("src",t+"&refresh="+a):e.attr("src",t+"?refresh="+a)}),t.on("reloading",function(){$("#loader").show()}),t.on("refresh",function(){window.location.reload(!0)})}();