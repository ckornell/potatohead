function randomCacheBuster(e,t){return Math.ceil(Math.random()*t*e)}$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},function(){function e(e){var a=$("#preview_iframe"),r=$(e),i=r.text().trim().replace(".html",""),n=t(r.data("section"),i);o.show(),a.attr("src",n)}function t(e,t){var o="http://localhost:3008?layout=default";switch(e){case"header":o+="&views:header=header/";break;case"footer":o+="&views:footer=footer/";break;case"layouts":o="http://localhost:3008?layout=";break;case"categories":o+="&views:categories=categories/";break;case"home":o+="&views:home=home/"}"slide_menu"===t&&(o="http://localhost:3008?layout=slide_menu&views:header=header/");var r=o+t+"&refresh="+randomCacheBuster(100,300);return a.clear(),a.makeCode(r),r}var a,o=$("#loader");$(".submenu > li a").on("click",function(){var t=$(this);e(t)}),a=new QRCode("qrcode",{text:"http://localhost:3008?layout=default",width:128,height:128,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H}),document.getElementById("preview_iframe").onload=function(){o.hide()}}(),function(){$(".menu > li a").on("click",function(){var e=$(this);e.parent().find("> .submenu").toggle(),e.toggleClass("open")}),$(".minicolors").minicolors({control:"wheel",theme:"default",defaultValue:"#fff"}),$(".section-btn-header").on("click",function(e){e.preventDefault();var t=$(this);t.next(".variables").toggle(),t.toggleClass("open")})}(),function(){var e=io.connect("http://localhost:2000");$(".submit-change").on("click",function(t){t.preventDefault(),t.stopPropagation();var a=$(this).data("section"),o=$(this).parents("form").serializeObject();e.emit("stylus rewrite",{directive:a,form:o})}),e.on("refreshFrame",function(){$("#loader").show();var e=$("#preview_iframe"),t=e.attr("src"),a=randomCacheBuster(2e3,1e3);/\?layout/g.test(t)?e.attr("src",t+"&refresh="+a):e.attr("src",t+"?refresh="+a)}),e.on("reloading",function(){$("#loader").show()}),e.on("refresh",function(){window.location.reload(!0)})}();